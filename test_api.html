<!DOCTYPE html>
<html>
<head>
    <title>Test API Properties</title>
    <script>
        async function testAPI() {
            const outputDiv = document.getElementById('output');
            outputDiv.innerHTML = 'Testing...';
            
            try {
                // Login first
                const loginData = new FormData();
                loginData.append('email', 'admin@telkom.com');
                loginData.append('password', 'admin123');
                
                const loginResponse = await fetch('/login', {
                    method: 'POST',
                    body: loginData
                });
                
                console.log('Login response:', loginResponse.status);
                
                if (loginResponse.status === 200) {
                    // Test admin properties
                    const propertiesResponse = await fetch('/api/admin/properties');
                    console.log('Properties response:', propertiesResponse.status);
                    
                    if (propertiesResponse.status === 200) {
                        const data = await propertiesResponse.json();
                        outputDiv.innerHTML = `
                            <h3>All Properties (${data.total})</h3>
                            <ul>
                                ${data.properties.map(prop => 
                                    `<li>ID: ${prop.id}, Type: ${prop.property_type}, Title: ${prop.title}</li>`
                                ).join('')}
                            </ul>
                        `;
                        
                        // Test tanah_bangunan filter
                        const tbResponse = await fetch('/api/admin/properties?property_type=tanah_bangunan');
                        if (tbResponse.status === 200) {
                            const tbData = await tbResponse.json();
                            outputDiv.innerHTML += `
                                <h3>Tanah+Bangunan Properties (${tbData.total})</h3>
                                <ul>
                                    ${tbData.properties.map(prop => 
                                        `<li>ID: ${prop.id}, Type: ${prop.property_type}, Title: ${prop.title}</li>`
                                    ).join('')}
                                </ul>
                            `;
                        }
                    } else {
                        outputDiv.innerHTML = `Error getting properties: ${propertiesResponse.status}`;
                    }
                } else {
                    outputDiv.innerHTML = `Login failed: ${loginResponse.status}`;
                }
            } catch (error) {
                outputDiv.innerHTML = `Error: ${error.message}`;
                console.error('Error:', error);
            }
        }
        
        function goToDashboard() {
            window.location.href = '/admin/dashboard';
        }
    </script>
</head>
<body>
    <h1>Test API Properties</h1>
    <button onclick="testAPI()">Test API</button>
    <button onclick="goToDashboard()">Go to Dashboard</button>
    <div id="output"></div>
</body>
</html>
